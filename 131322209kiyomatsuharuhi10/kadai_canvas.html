<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8">
<title>canvas_with_text.html</title>
</head>

<body>
<section>
<h1>âœ¨ğŸ’–CANVASğŸ’–âœ¨</h1>
<nav>
<label for="colorPicker">ç·šã®è‰²ğŸ¨ï¼š</label>
<input type="color" id="colorPicker" value="#ccc">
<label for="lineWidth">ç·šã®å¤ªã•ï¼š</label>
<input type="range" id="lineWidth" value="3" min="1" max="20">
<br>
<label for="textInput">ãƒ†ã‚­ã‚¹ãƒˆï¼š</label>
<input type="text" id="textInput" placeholder="ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›">
<button id="clear_btn">å‰Šé™¤</button>
</nav>
<canvas id="drawArea" width="1050" height="500" style="border: 1px solid rgb(211, 29, 217);"></canvas>
</section>

<script src="js/jquery-2.1.3.min.js"></script>
<script>
$(document).ready(function () {
const canvas = $("#drawArea")[0]; // Canvas Element
const ctx = canvas.getContext("2d"); // æç”»ã™ã‚‹ãŸã‚ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

let canvasMouseEvent = false; // ãƒšãƒ³ã‚’å¼•ãã‚¹ã‚¤ãƒƒãƒ [ true=ãƒšãƒ³ã‚’å¼•ã, false=ãƒšãƒ³ã‚’å¼•ã‹ãªã„ ]
let oldX = 0; // ï¼‘ã¤å‰ã®Xåº§æ¨™ã‚’ä¿æŒã™ã‚‹å¤‰æ•°
let oldY = 0; // ï¼‘ã¤å‰ã®Yåº§æ¨™ã‚’ä¿æŒã™ã‚‹å¤‰æ•°

// Canvasä¸Šã§ã®ãƒã‚¦ã‚¹ãƒ€ã‚¦ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
$("#drawArea").mousedown(function (e) {
oldX = e.offsetX; // ãƒã‚¦ã‚¹ãƒ€ã‚¦ãƒ³æ™‚ã®Xåº§æ¨™å–å¾—
oldY = e.offsetY; // ãƒã‚¦ã‚¹ãƒ€ã‚¦ãƒ³æ™‚ã®Yåº§æ¨™å–å¾—
canvasMouseEvent = true;
});

// Canvasä¸Šã§ã®ãƒã‚¦ã‚¹ç§»å‹•ã‚¤ãƒ™ãƒ³ãƒˆ
$("#drawArea").mousemove(function (e) {
if (canvasMouseEvent) {
const currentX = e.offsetX;
const currentY = e.offsetY;

ctx.strokeStyle = $("#colorPicker").val(); // é¸æŠã•ã‚ŒãŸè‰²ã‚’è¨­å®š
ctx.lineWidth = $("#lineWidth").val(); // é¸æŠã•ã‚ŒãŸå¤ªã•ã‚’è¨­å®š
ctx.lineJoin = "round";
ctx.lineCap = "round";

ctx.beginPath();
ctx.moveTo(oldX, oldY);
ctx.lineTo(currentX, currentY);
ctx.stroke();

oldX = currentX;
oldY = currentY;
}
});

// Canvasä¸Šã§ã®ãƒã‚¦ã‚¹ã‚¢ãƒƒãƒ—ã‚¤ãƒ™ãƒ³ãƒˆ
$("#drawArea").mouseup(function () {
canvasMouseEvent = false;
});

// ã‚¯ãƒªã‚¢ãƒ¼ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
$("#clear_btn").click(function () {
ctx.clearRect(0, 0, canvas.width, canvas.height);
});

// ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã®ã‚­ãƒ¼ã‚¢ãƒƒãƒ—ã‚¤ãƒ™ãƒ³ãƒˆ
$("#textInput").keyup(function () {
const text = $("#textInput").val();
ctx.fillStyle = $("#colorPicker").val();
ctx.font = "20px Arial";

// ãƒ†ã‚­ã‚¹ãƒˆã®å¹…ã‚’å–å¾—
const textWidth = ctx.measureText(text).width;

// ãƒ†ã‚­ã‚¹ãƒˆãŒã‚­ãƒ£ãƒ³ãƒã‚¹å¤–ã«å‡ºãªã„ã‚ˆã†ã«èª¿æ•´
let x = oldX=10;
let y = oldY=23;

ctx.clearRect(0, 0, canvas.width, canvas.height);
ctx.fillText(text, x, y);
});
});
</script>
</body>

</html>
